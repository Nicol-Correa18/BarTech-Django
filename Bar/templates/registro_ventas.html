{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Registro de Ventas</title>
    <link rel="stylesheet" href="{% static 'css/fiados1.css' %}" />
    <link rel="stylesheet" href="{% static 'css/menu.css' %}">

</head>
<body>
    <header><h1>Registro de Ventas</h1></header>
<div class="inventory-container">
        <div class="menu-icon" onclick="toggleMenu()"></div>
        <div id="overlay"></div>
      </div>
      <div class="menu">
        <ul>
          <li><button class="custom-button"><a href="{% url 'index' %}">Inicio</a></button></li> 
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'registro_horarios' %}">Horarios</a></button></li>{% endif %}
          <li><button class="custom-button"><a href="{% url 'lista_fiados' %}">Deben</a></button></li>
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'nuevo_producto' %}">Nuevo producto</a></button></li>{% endif %}
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'listar_categoria' %}">Nueva categoría</a></button></li>{% endif %}
          <li><button class="custom-button"><a href="{% url 'carrito' %}">Carrito</a></button></li>
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'listar_usuarios' %}">Usuarios</a></button></li>{% endif %}
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'descargar_pdf_detalle_carrito' %}">Facturas</a></button></li>{% endif %}
          {% if request.session.path.rol == 2 %}<li><button class="custom-button"><a href="{% url 'registro_ventas' %}">Registro de Ventas</a></button></li>{% endif %}
          <li><button class="custom-button"><a href="{% url 'logout' %}">Cerrar Sesión</a></button></li>
        </ul>
</div>
{% if messages %}
      <div id="messages">
          {% for message in messages %}
              <div class="alert {{ message.tags }}">
                  {{ message }}
              </div>
          {% endfor %}
      </div>
  {% endif %}
    {% for categoria_data in data %}
        <section class="categoria">
            <h2>{{ categoria_data.categoria_nombre }}</h2>
            <table>
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Stock Disponible</th>
                        <th>Ventas Realizadas</th>
                        <th>Precio Unitario</th>
                        <th>Margen de Ganancia</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in categoria_data.productos %}
                        <tr>
                            <td>{{ item.producto.nombre }}</td>
                            <td>{{ item.stock }}</td>
                            <td>{{ item.total_ventas }}</td>
                            <td class="moneda">${{ item.precio_unitario }}</td>
                            <td class="moneda">${{ item.margen_ganancia }}</td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="5">No hay productos en esta categoría.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
    {% empty %}
        <p>No hay categorías registradas.</p>
    {% endfor %}
    <script src="{% static 'js/mensajes.js' %}"></script>
    <script src="{% static 'js/scripts.js' %}"></script>
</body>
</html>